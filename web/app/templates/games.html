{% extends "base.html" %}
{% block content %}
<h1 class="text-2xl font-bold mb-4">Games Schedule</h1>

<div class="bg-white rounded-xl shadow p-5">
  <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
    <div class="flex flex-wrap items-center gap-2">
      {% for tab in league_tabs %}
      <a href="{{ tab.url }}"
         class="px-3 py-1.5 rounded-full text-sm font-semibold transition
                {% if tab.active %}bg-blue-600 text-white shadow{% else %}bg-gray-100 text-gray-700 hover:bg-gray-200{% endif %}">
        {{ tab.label }}
      </a>
      {% endfor %}
    </div>

    <div class="text-center md:text-right">
      <p class="text-sm text-gray-500 uppercase tracking-wide">Week</p>
      <p class="text-lg font-semibold">{{ week_label }}</p>
    </div>

    <div class="flex items-center gap-2 justify-end">
      <a href="/games?league={{ league }}&week={{ prev_week }}" class="px-3 py-1.5 rounded border border-gray-300 text-sm hover:bg-gray-100">◀ Previous</a>
      <a href="/games?league={{ league }}&week=0"
         class="px-3 py-1.5 rounded border text-sm {% if is_current_week %}border-blue-500 text-blue-600 bg-blue-50{% else %}border-gray-300 hover:bg-gray-100 text-gray-700{% endif %}">
        This Week
      </a>
      <a href="/games?league={{ league }}&week={{ next_week }}" class="px-3 py-1.5 rounded border border-gray-300 text-sm hover:bg-gray-100">Next ▶</a>
    </div>
  </div>

  <div class="mt-6 grid gap-6">
    {% for day in schedule_days %}
    <section class="bg-gray-50 rounded-xl p-4 border border-gray-100">
      <h2 class="text-lg font-semibold mb-3">{{ day.day.strftime('%A, %b %d') }}</h2>
      {% if day.games %}
      <div class="space-y-3">
        {% for game in day.games %}
        <article class="bg-white rounded-lg border border-gray-200 p-4 shadow-sm">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
            <div>
              <h3 class="font-semibold text-gray-900">{{ game.short_name or game.name }}</h3>
              <p class="text-sm text-gray-500">{{ game.status_detail or game.status }}</p>
              {% if game.odds %}
              <p class="text-xs text-gray-500 mt-1 flex flex-wrap items-center gap-2">
                <span class="font-semibold text-gray-600">{{ game.odds.provider or 'Odds' }}</span>
                {% if game.odds.details %}
                <span>{{ game.odds.details }}</span>
                {% endif %}
                {% if game.odds.spread %}
                <span>Spread {{ game.odds.spread }}</span>
                {% endif %}
                {% if game.odds.over_under %}
                <span>O/U {{ game.odds.over_under }}</span>
                {% endif %}
              </p>
              {% endif %}
            </div>
            <div class="text-sm text-gray-600 text-right">
              <p>{{ game.start_time }}</p>
              {% if game.venue %}
              <p>{{ game.venue }}</p>
              {% endif %}
              {% if game.networks %}
              <p class="text-xs text-gray-400 mt-1 uppercase tracking-wide">{{ game.networks }}</p>
              {% endif %}
            </div>
          </div>

          <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3">
            {% for team in game.teams %}
            <div class="flex items-center justify-between bg-gray-50 rounded-lg px-3 py-2 border border-gray-100">
              <div class="flex items-center gap-3">
                {% if team.logo %}
                <img src="{{ team.logo }}" alt="{{ team.name }} logo" class="w-10 h-10 object-contain bg-white rounded-full border border-gray-200" loading="lazy" />
                {% else %}
                <span class="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-500 text-xs uppercase">{{ team.abbreviation or team.name[:2] }}</span>
                {% endif %}
                <div>
                  <p class="font-medium text-gray-900">{{ team.name }}</p>
                  {% if team.record %}
                  <p class="text-xs text-gray-500">{{ team.record }}</p>
                  {% endif %}
                </div>
              </div>
              <div class="text-right">
                <p class="text-lg font-semibold text-gray-800">{{ team.score or '—' }}</p>
                <p class="text-xs uppercase tracking-wide text-gray-400">{{ 'Home' if team.is_home else 'Away' }}</p>
                {% if team.moneyline %}
                <p class="text-xs text-gray-500">ML {{ team.moneyline }}</p>
                {% endif %}
                {% if team.spread %}
                <p class="text-xs text-gray-500">Spread {{ team.spread }}{% if team.spread_odds %} ({{ team.spread_odds }}){% endif %}</p>
                {% endif %}
                {% if team.favorite is not none %}
                <p class="text-xs uppercase tracking-wide {% if team.favorite %}text-emerald-600{% else %}text-slate-500{% endif %}">
                  {{ 'Favorite' if team.favorite else 'Underdog' }}
                </p>
                {% endif %}
              </div>
            </div>
            {% endfor %}
          </div>
        </article>
        {% endfor %}
      </div>
      {% else %}
      <p class="text-sm text-gray-500">No games scheduled.</p>
      {% endif %}
    </section>
    {% endfor %}
  </div>
</div>
{% endblock %}
